---
title: "TP3"
author: "Matthias LAPU | Amael KREIS"
date: "2023-03-31"
output: html_document
---

# Estimation du maximum de vraisemblance et de l'intervalle de confiance

## Vraisemblance: La loi de Bernoulli

### Question 1
```{r Bernoulli}
echantillon <- rbinom(10,1,0.6)
print(x)
```
Une façon simple d'estimer p est de calculer la moyenne empirique de l'échantillon
```{r Bernoulli moy}
print(mean(echantillon))
```

### Question 2

```{r Bernoulli vraisemblance}
L_bern <- function(p,x) {
  n <- sum(x)
  return(p^n * (1-p)^(length(x) - n))
}
```

### Question 3

```{r vraisemblance}
p <- seq(0,1,length.out = 100)
plot(p,L_bern(p,echantillon),type = "l")
```

### Question 4

```{r optim}
fn <- function(p){
  r <-L_bern(p,echantillon)
  return(1 - r)
}
optim(par = 0.5,fn,method = "L-BFGS-B",lower = 0,upper = 1)

```
### Question 5
```{r Bernoulli echantillon de tailles differentes}
res <- c()
for(i in seq(10,2000,10)){
  echantillon <- rbinom(i,1,0.6)
  res <- c(res,optim(par = 0.2,fn,method = "L-BFGS-B",lower = 0,upper = 1)[[1]])
}
```

Il faut utiliser la logvraisemblance -> faire des maths





# Vraisemblance pour plusieurs paramètre : La Loi Gamma 

7. Présentez l'histogramme des données simulées. Choisir 3 paramètres candidats, 

```{r}
n = 25
gamma0 <- rgamma(n,c(2.5,1.5))
hist(gamma0)
hist(rgamma(n,c(3,4)))
hist(rgamma(n,c(2,6)))
```
 8.Ecrire la log vraisemblance 
 
 la formule de la vraisemblance de la loi gamma est : 
 $$
 L(\alpha ,\beta |x)={\frac {\beta ^{\alpha }}{\Gamma (\alpha )}}x^{\alpha -1}\exp(-\beta x)
 $$
 $$
 \log L(\alpha ,\beta |x)=\alpha \log \beta -\log \Gamma (\alpha )+(\alpha -1)\log x-\beta x
 $$
 
```{r}
logL_gamma_unit <- function(alpha,beta,x){
  return( alpha*log(beta) - log(gamma(alpha)) + (alpha-1)*log(x) - beta*x ) 
}

logL_gamma <- function(alpha,beta,interval){
  sum <- 0
  for(i in interval) {
    sum =  sum + logL_gamma_unit(alpha,beta,i)
  }
  return (sum)
}
```
 
Pour votre échantillon , estimer la log-vraisemblance de paramètre \theta en faisant varier 1 paramètre à la fois. On va estimer alpha et beta de [0;10], alpha et beta sont > 0 

```{r}
array <- c()
interval <- seq(1,10)
for(i in interval){
  for(j in interval){
    array <- c(array,logL_gamma(i,j,gamma0));
  }
}
print(mean(array)); # la moyenne d'un tableau
```

9.Tracer la courbe des valeurs ainsi calculés.
```{r}
print(array)
```
